# 组件使用文档 - 第一周开发成果

> 文档版本：v1.0  
> 更新时间：2025年10月27日  
> 作者：开发者A

---

## 目录

1. [公共组件](#公共组件)
   - [AppHeader - 顶部导航](#appheader---顶部导航)
   - [BottomNav - 底部导航](#bottomnav---底部导航)
   - [ThemeSelector - 主题选择器](#themeselector---主题选择器)
2. [小说组件](#小说组件)
   - [NovelCard - 小说卡片](#novelcard---小说卡片)
   - [MasonryLayout - 瀑布流布局](#masonrylayout---瀑布流布局)
3. [工具函数](#工具函数)
   - [useTheme - 主题管理](#usetheme---主题管理)
4. [使用示例](#使用示例)

---

## 公共组件

### AppHeader - 顶部导航

**文件位置：** `src/components/common/AppHeader.vue`

**功能描述：**
- 桌面端和移动端自适应导航栏
- 集成主题选择器和暗色模式切换
- 支持搜索功能（带防抖）
- 导航菜单路由高亮

**使用方法：**

```vue
<template>
  <div>
    <AppHeader />
    <!-- 其他内容 -->
  </div>
</template>

<script setup>
import AppHeader from '@/components/common/AppHeader.vue'
</script>
```

**Props：** 无（所有功能都是内置的）

**特性：**
- ✅ 响应式设计
- ✅ 主题切换
- ✅ 暗色模式
- ✅ 路由高亮
- ✅ 搜索建议

---

### BottomNav - 底部导航

**文件位置：** `src/components/common/BottomNav.vue`

**功能描述：**
- 移动端固定底部导航栏
- 三个导航项：发现、推荐、书架
- 当前页面高亮显示
- 触摸反馈动画

**使用方法：**

```vue
<template>
  <div>
    <!-- 页面内容 -->
    <BottomNav />
  </div>
</template>

<script setup>
import BottomNav from '@/components/common/BottomNav.vue'
</script>
```

**Props：** 无

**特性：**
- ✅ 仅在移动端显示
- ✅ 毛玻璃背景效果
- ✅ 路由自动高亮
- ✅ 触摸动画
- ✅ 安全区域适配

**样式说明：**
```css
/* 桌面端隐藏 */
@media (min-width: 768px) {
  .bottom-nav {
    display: none;
  }
}
```

---

### ThemeSelector - 主题选择器

**文件位置：** `src/components/common/ThemeSelector.vue`

**功能描述：**
- 三套主题选择：玫瑰温情、雅致高级、文物古韵
- 颜色预览块
- 下拉菜单展示
- 平滑动画过渡

**使用方法：**

```vue
<template>
  <!-- 桌面端样式 -->
  <ThemeSelector />
  
  <!-- 移动端样式 -->
  <ThemeSelector :mobile="true" />
</template>

<script setup>
import ThemeSelector from '@/components/common/ThemeSelector.vue'
</script>
```

**Props：**

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| mobile | Boolean | false | 是否使用移动端样式 |

**特性：**
- ✅ 颜色预览
- ✅ 当前主题标识
- ✅ 点击外部关闭
- ✅ 动画过渡

---

## 小说组件

### NovelCard - 小说卡片

**文件位置：** `src/components/novel/NovelCard.vue`

**功能描述：**
- 展示小说封面、标题、作者等信息
- 支持卡片和列表两种布局
- 图片懒加载
- 简介展开/收起
- 悬停动画效果

**使用方法：**

```vue
<template>
  <!-- 卡片布局 -->
  <NovelCard :novel="novelData" />
  
  <!-- 列表布局 -->
  <NovelCard :novel="novelData" layout="list" />
  
  <!-- 不显示简介 -->
  <NovelCard :novel="novelData" :show-description="false" />
</template>

<script setup>
import NovelCard from '@/components/novel/NovelCard.vue'

const novelData = {
  id: 1,
  title: '修真世界',
  author: '方想',
  cover: 'https://example.com/cover.jpg',
  category: '仙侠',
  description: '这是一个关于修真的故事...',
  wordCount: 5000000,
  likes: 100000,
  status: 'completed' // ongoing 或 completed
}
</script>
```

**Props：**

| 参数 | 类型 | 默认值 | 必填 | 说明 |
|------|------|--------|------|------|
| novel | Object | - | 是 | 小说数据对象 |
| layout | String | 'card' | 否 | 布局模式：card 或 list |
| showDescription | Boolean | true | 否 | 是否显示简介 |

**Novel 对象结构：**

```typescript
interface Novel {
  id: number              // 小说ID
  title: string           // 标题
  author: string          // 作者
  cover: string           // 封面图片URL
  category: string        // 分类
  description: string     // 简介
  wordCount: number       // 字数
  likes: number           // 点赞数
  status: 'ongoing' | 'completed'  // 状态
}
```

**事件：**
- 点击卡片自动跳转到阅读页 `/reading/${novel.id}`

**特性：**
- ✅ 图片懒加载
- ✅ 骨架屏加载
- ✅ 悬停3D效果
- ✅ 简介展开/收起
- ✅ 数字格式化（万为单位）

---

### MasonryLayout - 瀑布流布局

**文件位置：** `src/components/novel/MasonryLayout.vue`

**功能描述：**
- 响应式瀑布流布局
- 自动加载更多
- 骨架屏加载状态
- 空状态展示

**使用方法：**

```vue
<template>
  <MasonryLayout
    :novels="novelList"
    :loading="isLoading"
    :has-more="hasMoreData"
    :columns="3"
    :show-description="true"
    :auto-load="true"
    @load-more="handleLoadMore"
  />
</template>

<script setup>
import { ref } from 'vue'
import MasonryLayout from '@/components/novel/MasonryLayout.vue'

const novelList = ref([])
const isLoading = ref(false)
const hasMoreData = ref(true)

const handleLoadMore = () => {
  isLoading.value = true
  // 加载数据逻辑
  // ...
  isLoading.value = false
}
</script>
```

**Props：**

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| novels | Array | [] | 小说列表数据 |
| loading | Boolean | false | 是否正在加载 |
| hasMore | Boolean | true | 是否还有更多数据 |
| columns | Number | 3 | 列数（1/2/3） |
| showDescription | Boolean | true | 是否显示简介 |
| autoLoad | Boolean | true | 是否自动加载 |

**Events：**

| 事件名 | 参数 | 说明 |
|--------|------|------|
| load-more | - | 需要加载更多数据时触发 |

**插槽：**

```vue
<MasonryLayout :novels="novels">
  <template #item="{ novel }">
    <!-- 自定义卡片内容 -->
    <div>{{ novel.title }}</div>
  </template>
</MasonryLayout>
```

**响应式列数：**
- 桌面端 (>= 1024px): 3列
- 平板端 (768px - 1024px): 2列
- 移动端 (< 768px): 1列

**特性：**
- ✅ CSS瀑布流
- ✅ 自动加载更多
- ✅ 骨架屏加载
- ✅ 空状态处理
- ✅ 滚动节流优化

---

## 工具函数

### useTheme - 主题管理

**文件位置：** `src/composables/useTheme.js`

**功能描述：**
- 主题切换管理
- 明暗模式切换
- CSS变量动态更新
- LocalStorage持久化

**使用方法：**

```vue
<template>
  <div>
    <p>当前主题：{{ currentThemeConfig.name }}</p>
    <p>当前模式：{{ currentMode }}</p>
    
    <button @click="setTheme('rose')">玫瑰温情</button>
    <button @click="setTheme('elegant')">雅致高级</button>
    <button @click="setTheme('vintage')">文物古韵</button>
    
    <button @click="toggleMode">切换明暗</button>
  </div>
</template>

<script setup>
import { useTheme } from '@/composables/useTheme'

const {
  currentTheme,
  currentMode,
  currentThemeConfig,
  setTheme,
  toggleMode,
  setMode,
  getCurrentThemeInfo
} = useTheme()

// 获取完整主题信息
const themeInfo = getCurrentThemeInfo()
console.log(themeInfo)
// {
//   theme: 'rose',
//   mode: 'light',
//   config: { name: '玫瑰温情', primary: '#d95468', ... }
// }
</script>
```

**API说明：**

#### 状态

| 名称 | 类型 | 说明 |
|------|------|------|
| currentTheme | Ref<string> | 当前主题名称 |
| currentMode | Ref<string> | 当前模式 (light/dark) |
| currentThemeConfig | ComputedRef<object> | 当前主题配置对象 |
| themeConfig | Object | 所有主题配置 |

#### 方法

| 方法名 | 参数 | 返回值 | 说明 |
|--------|------|--------|------|
| setTheme | (theme: string) | void | 设置主题 |
| toggleMode | () | void | 切换明暗模式 |
| setMode | (mode: string) | void | 设置模式 |
| getCurrentThemeInfo | () | Object | 获取当前主题完整信息 |
| applyThemeToDOM | (theme, mode) | void | 应用主题到DOM |

**主题配置结构：**

```javascript
themeConfig = {
  rose: {
    light: { /* 配置 */ },
    dark: { /* 配置 */ }
  },
  elegant: {
    light: { /* 配置 */ },
    dark: { /* 配置 */ }
  },
  vintage: {
    light: { /* 配置 */ },
    dark: { /* 配置 */ }
  }
}
```

**初始化：**

在 `main.js` 中已自动初始化：

```javascript
import { initTheme } from './composables/useTheme'

// 初始化主题系统
initTheme()
```

**特性：**
- ✅ 自动持久化
- ✅ 实时更新CSS变量
- ✅ 全局事件通知
- ✅ 降级处理

---

## 使用示例

### 示例1：完整页面布局

```vue
<template>
  <div class="page">
    <!-- 顶部导航 -->
    <AppHeader />
    
    <!-- 主内容 -->
    <main class="content">
      <h1>小说列表</h1>
      
      <!-- 瀑布流布局 -->
      <MasonryLayout
        :novels="novels"
        :loading="loading"
        :has-more="hasMore"
        @load-more="loadMore"
      />
    </main>
    
    <!-- 底部导航 -->
    <BottomNav />
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'
import AppHeader from '@/components/common/AppHeader.vue'
import BottomNav from '@/components/common/BottomNav.vue'
import MasonryLayout from '@/components/novel/MasonryLayout.vue'

const novels = ref([])
const loading = ref(false)
const hasMore = ref(true)

const loadMore = async () => {
  loading.value = true
  // 加载数据
  loading.value = false
}

onMounted(() => {
  loadMore()
})
</script>

<style scoped>
.page {
  padding-top: 4rem;
  padding-bottom: 5rem;
}

.content {
  max-width: 1280px;
  margin: 0 auto;
  padding: 2rem 1rem;
}
</style>
```

### 示例2：自定义主题

```vue
<template>
  <div>
    <button @click="changeTheme('rose')">玫瑰温情</button>
    <button @click="changeTheme('elegant')">雅致高级</button>
    <button @click="changeTheme('vintage')">文物古韵</button>
    <button @click="toggleDarkMode">切换暗色</button>
  </div>
</template>

<script setup>
import { useTheme } from '@/composables/useTheme'

const { setTheme, toggleMode } = useTheme()

const changeTheme = (theme) => {
  setTheme(theme)
}

const toggleDarkMode = () => {
  toggleMode()
}
</script>
```

### 示例3：自定义卡片样式

```vue
<template>
  <MasonryLayout :novels="novels">
    <template #item="{ novel }">
      <!-- 自定义卡片 -->
      <div class="custom-card">
        <img :src="novel.cover" :alt="novel.title" />
        <h3>{{ novel.title }}</h3>
        <p>{{ novel.author }}</p>
      </div>
    </template>
  </MasonryLayout>
</template>

<script setup>
import MasonryLayout from '@/components/novel/MasonryLayout.vue'

const novels = ref([/* 数据 */])
</script>

<style scoped>
.custom-card {
  /* 自定义样式 */
}
</style>
```

---

## CSS变量使用

### 主题颜色变量

```css
/* 在组件中使用主题颜色 */
.my-component {
  color: var(--color-text-primary);
  background-color: var(--color-bg-card);
  border: 1px solid var(--color-border);
}

.my-button {
  background-color: var(--color-primary);
  color: white;
}

.my-button:hover {
  background-color: var(--color-secondary);
}
```

### 可用的CSS变量

```css
--color-primary        /* 主色调 */
--color-secondary      /* 辅助色 */
--color-accent         /* 强调色 */
--color-tertiary       /* 第三色（部分主题） */
--color-highlight      /* 高亮色（部分主题） */
--color-bg-card        /* 卡片背景色 */
--color-text-primary   /* 主要文本颜色 */
--color-text-secondary /* 次要文本颜色 */
--color-text-muted     /* 弱化文本颜色 */
--color-border         /* 边框颜色 */
--color-shadow         /* 阴影颜色 */
```

---

## 注意事项

1. **主题切换**
   - 主题会自动保存到 LocalStorage
   - 页面刷新后会自动恢复上次的主题

2. **响应式适配**
   - AppHeader 在桌面端显示完整导航
   - BottomNav 仅在移动端显示
   - 瀑布流会根据屏幕宽度自动调整列数

3. **图片加载**
   - NovelCard 使用懒加载，需要提供有效的图片URL
   - 图片加载失败会显示占位图

4. **性能优化**
   - 搜索使用了300ms防抖
   - 滚动加载使用了100ms节流
   - 建议小说列表每页加载12-20条

5. **暗色模式**
   - 所有组件都支持暗色模式
   - 使用 CSS 变量自动适配

---

## 常见问题

### Q1: 主题切换后样式没有更新？

**A:** 确保在 `main.js` 中已经调用 `initTheme()`，并且组件使用了 CSS 变量。

### Q2: 瀑布流列数不正确？

**A:** 检查父容器宽度，瀑布流使用 CSS column-count，需要足够的宽度才能显示多列。

### Q3: 图片不显示？

**A:** 检查图片URL是否有效，如果URL无效会显示占位图。

### Q4: 移动端底部导航被遮挡？

**A:** 确保页面有 `padding-bottom: 5rem` 的底部内边距。

### Q5: 如何禁用自动加载更多？

**A:** 设置 `<MasonryLayout :auto-load="false">`，然后手动触发加载。

---

## 更新日志

### v1.0 (2025-10-27)
- ✅ 初始版本
- ✅ 完成6个核心组件
- ✅ 完成主题系统
- ✅ 完成文档编写

---

## 联系方式

如有问题或建议，请联系：

- **开发者A**
- **邮箱：** developer-a@example.com
- **文档位置：** `/docx/工作汇报文档/开发者A/`

---

**文档结束**

